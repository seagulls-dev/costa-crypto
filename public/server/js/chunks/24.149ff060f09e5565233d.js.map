{"version":3,"sources":["webpack:///./resources/components/ConfirmAction/index.js","webpack:///./resources/routes/chat/components/Body/components/ActivityCell/index.js","webpack:///./resources/routes/chat/components/Body/components/AttachmentCell/index.js","webpack:///./resources/routes/chat/components/Body/components/ChatNotFound/index.js","webpack:///./resources/routes/chat/components/Body/components/MarketplaceRating/index.js","webpack:///./resources/routes/chat/components/Body/components/MarketplaceTrade/components/PriceCard/index.js","webpack:///./resources/routes/chat/components/Body/components/MarketplaceTrade/components/VerificationForm/index.js","webpack:///./resources/routes/chat/components/Body/components/MarketplaceTrade/index.js","webpack:///./resources/routes/chat/components/Body/components/TextCell/index.js","webpack:///./resources/routes/chat/components/Body/index.js","webpack:///./resources/routes/chat/components/Empty/index.js","webpack:///./resources/routes/chat/components/Menu/components/ChatCell/index.js","webpack:///./resources/routes/chat/components/Menu/index.js","webpack:///./resources/routes/chat/index.js"],"names":["ConfirmAction","Component","ActivityCell","message","utcDateCalendarTime","activity","time","body","user","AttachmentCell","mimeType","attachment","link","truncate","mode","itemClass","NotFound","onToggleDrawer","TextArea","messages","defineMessages","successful","review","MarketplaceRating","e","form","intl","trade","axios","route","endpoint","id","handleFormSuccess","loading","submitted","handleFormError","auth","getFieldDecorator","handleSubmit","rules","type","required","min","max","resize","mapStateToProps","pipe","connect","formHelper","PriceCard","styleName","name","price","twoFactorCode","password","VerificationForm","onCancel","onSubmit","values","withTwoFactor","cancel","Countdown","approved","disputed","cancelled","confirmed","MarketplaceTrade","content","whiteSpace","onUpdate","code","handleSuccess","handleError","deadline","moment","confirmedAt","createdAt","cancelsAt","disputableAfter","timeElapsed","showVerificationForm","twoFactorSetting","action","seller","offerAmount","buyer","maxWidth","TextCell","inputMessage","Body","data","chat","chatId","text","sendingText","status","sendingAttachment","errors","filters","params","nextParams","current","nextHasMore","Boolean","page","hasMore","total","element","console","Array","sortDate","a","b","loadingMore","participant","value","marketplaceTradeDrawerState","ref","simpleBar","loadingChat","pageSize","marketplaceTrade","container","activeChat","token","participants","o","profileLink","length","fullscreen","onChangeFullscreen","onToggleFullscreen","uploadEndpoint","color","record","isOwner","item","maxHeight","onChangeText","sendText","Empty","ChatCell","participation","onOpen","onChatUpdated","prevProps","prevState","snapshot","prevChat","chatTitle","latestMessage","messageBy","active","millify","unreadCount","cellClass","handleClick","Item","searchUsers","Menu","chat_id","chats","index","clearTimeout","setTimeout","updatedData","history","path","generatePath","menuItemLinks","prevUser","totalActiveTrades","backgroundColor","handleChatOpen","pageTitle","Chats","drawerState","state","location","match","matchPath","exact","strict","context","sidebar","module"],"mappings":"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","file":"js/chunks/24.149ff060f09e5565233d.js","sourcesContent":["import React, {Component} from 'react';\r\nimport {FormattedMessage} from \"react-intl\";\r\nimport {Popconfirm} from \"antd\";\r\n\r\nclass ConfirmAction extends Component {\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<Popconfirm\r\n\t\t\t\ttitle={\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tdefaultMessage=\"Are you sure?\"\r\n\t\t\t\t\t\tid=\"common.popconfirm_title\"/>\r\n\t\t\t\t}\r\n\t\t\t\tcancelText={\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tdefaultMessage=\"No\"\r\n\t\t\t\t\t\tid=\"common.no\"/>\r\n\t\t\t\t}\r\n\t\t\t\tokText={\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tdefaultMessage=\"Yes\"\r\n\t\t\t\t\t\tid=\"common.yes\"/>\r\n\t\t\t\t}\r\n\t\t\t\t{...this.props}/>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default ConfirmAction;","import React, {Component} from 'react';\r\nimport {Divider, List} from \"antd\";\r\nimport {utcDateCalendarTime} from \"support/utils/common\";\r\nimport {FormattedMessage} from \"react-intl\";\r\nimport {isEmpty} from \"lodash\";\r\n\r\nclass ActivityCell extends Component {\r\n\tgetTimestamp() {\r\n\t\tconst {message} = this.props;\r\n\t\treturn (\r\n\t\t\t<span className=\"font-weight-semi-bold\">\r\n\t\t\t\t{utcDateCalendarTime(message.created_at)}\r\n\t\t\t</span>\r\n\t\t);\r\n\t}\r\n\r\n\tgetUserName() {\r\n\t\tconst {message} = this.props;\r\n\t\tif (isEmpty(message.user)) {\r\n\t\t\treturn (\r\n\t\t\t\t<FormattedMessage\r\n\t\t\t\t\tdefaultMessage=\"Unknown User\"\r\n\t\t\t\t\tid=\"common.unknown_user\"/>\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\treturn (\r\n\t\t\t\t<span className=\"font-weight-medium\">\r\n\t\t\t\t\t{message.user.name}:\r\n\t\t\t\t</span>\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {message} = this.props;\r\n\t\tconst activity = message.activity;\r\n\r\n\t\tif (isEmpty(activity) || !activity.body) {\r\n\t\t\treturn <List.Item/>;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<Divider className=\"font-weight-normal\"\r\n\t\t\t         dashed={true}>\r\n\t\t\t\t<small>\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"chat.activity_body\"\r\n\t\t\t\t\t\tdefaultMessage=\"{user} {body} {time}\"\r\n\t\t\t\t\t\tvalues={{\r\n\t\t\t\t\t\t\ttime : this.getTimestamp(),\r\n\t\t\t\t\t\t\tbody : activity.body,\r\n\t\t\t\t\t\t\tuser : this.getUserName(),\r\n\t\t\t\t\t\t}}/>\r\n\t\t\t\t</small>\r\n\t\t\t</Divider>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default ActivityCell;","import React, {Component} from 'react';\r\nimport UserAvatar from \"components/UserAvatar\";\r\nimport {truncate, utcDateCalendarTime} from \"support/utils/common\";\r\nimport {FormattedMessage} from \"react-intl\";\r\nimport {isEmpty} from \"lodash\";\r\nimport {Link} from \"react-router-dom\";\r\nimport {Button} from \"antd\";\r\n\r\nclass AttachmentCell extends Component {\r\n\tgetUserAvatar = () => {\r\n\t\tconst {message} = this.props;\r\n\t\tconst user = message.user;\r\n\t\treturn (\r\n\t\t\t<Link to={`/profile/${user.name}`}>\r\n\t\t\t\t<UserAvatar\r\n\t\t\t\t\tclassName=\"align-self-end\"\r\n\t\t\t\t\tuser={user} size={40}/>\r\n\t\t\t</Link>\r\n\t\t)\r\n\t};\r\n\r\n\tgetAttachmentDetail() {\r\n\t\tconst {message} = this.props;\r\n\t\tconst attachment = message.attachment;\r\n\t\tconst link = attachment.url;\r\n\r\n\t\tif (!isEmpty(attachment)) {\r\n\t\t\treturn (\r\n\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t<div className=\"cp-attachment d-flex\">\r\n\t\t\t\t\t\t<span className=\"mr-2\">\r\n\t\t\t\t\t\t\t<i className=\"la la-paperclip cp-fs-lg\"/>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<span className=\"mr-2 fs-sm\">\r\n\t\t\t\t\t\t\t{truncate(attachment.name, 20)}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<Button className=\"ml-0 mb-0\"\r\n\t\t\t\t\t\t        type=\"dashed\"\r\n\t\t\t\t\t\t        shape=\"circle\" href={link}\r\n\t\t\t\t\t\t        icon=\"download\"/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</React.Fragment>\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\treturn (\r\n\t\t\t\t<div className=\"cp-attachment d-flex\">\r\n\t\t\t\t\t<i className=\"la la-ban cp-fs-lg mr-2\"/>\r\n\t\t\t\t\t<span>\r\n\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\tdefaultMessage=\"Attachment Deleted\"\r\n\t\t\t\t\t\t\tid=\"chats.attachment_deleted\"/>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\r\n\tisImageType = (mimeType) => {\r\n\t\treturn mimeType === 'image/jpeg' || mimeType === 'image/png'\r\n\t};\r\n\r\n\tgetTimestamp() {\r\n\t\tconst {message} = this.props;\r\n\t\treturn (\r\n\t\t\t<small className=\"text-muted\">\r\n\t\t\t\t{utcDateCalendarTime(message.created_at)}\r\n\t\t\t</small>\r\n\t\t);\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {mode} = this.props;\r\n\r\n\t\tconst itemClass = mode === 'right' ?\r\n\t\t\t\"cp-chat-item flex-row-reverse\" : \"cp-chat-item\";\r\n\r\n\t\treturn (\r\n\t\t\t<div className={itemClass}>\r\n\t\t\t\t{this.getUserAvatar()}\r\n\t\t\t\t<div className=\"cp-bubble-block\">\r\n\t\t\t\t\t<div className=\"cp-bubble d-inline-block\">\r\n\t\t\t\t\t\t<div className=\"cp-message mb-2\">\r\n\t\t\t\t\t\t\t{this.getAttachmentDetail()}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"cp-time text-right\">\r\n\t\t\t\t\t\t\t{this.getTimestamp()}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default AttachmentCell;","import React, {Component} from 'react';\r\nimport {Button, Result} from \"antd\";\r\nimport {FormattedMessage} from \"react-intl\";\r\n\r\nclass NotFound extends Component {\r\n\trender() {\r\n\t\tconst {onToggleDrawer} = this.props;\r\n\t\treturn (\r\n\t\t\t<div className=\"d-flex align-items-center w-100\">\r\n\t\t\t\t<div className=\"text-center w-100\">\r\n\t\t\t\t\t<Result\r\n\t\t\t\t\t\ttitle={\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tdefaultMessage=\"Chat could not be found.\"\r\n\t\t\t\t\t\t\t\tid=\"chats.chat_not_found_title\"/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\textra={\r\n\t\t\t\t\t\t\t<Button type=\"primary\"\r\n\t\t\t\t\t\t\t        className=\"d-inline-block d-lg-none mt-3\"\r\n\t\t\t\t\t\t\t        onClick={onToggleDrawer}>\r\n\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\tdefaultMessage=\"Show Chats\"\r\n\t\t\t\t\t\t\t\t\tid=\"chat.show_chats\"/>\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsubTitle={\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tdefaultMessage=\"Please, select a new chat to display!\"\r\n\t\t\t\t\t\t\t\tid=\"chats.chat_not_found_sub_title\"/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstatus=\"404\"/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default NotFound;","import React, {Component} from 'react';\r\nimport Auth from \"support/Auth\";\r\nimport {pipe} from \"support/utils/common\";\r\nimport {connect} from \"react-redux\";\r\nimport {defineMessages, FormattedMessage} from \"react-intl\";\r\nimport {Button, Comment, Form, Input, Rate} from \"antd\";\r\nimport ApiService from \"support/Services/Api\";\r\nimport {isEmpty} from \"lodash\";\r\nimport {handleFormError, handleFormSuccess} from \"support/utils/promise\";\r\nimport formHelper from \"support/Helpers/Form\";\r\n\r\nconst TextArea = Input.TextArea;\r\n\r\nconst messages = defineMessages({\r\n\tsuccessful : {\r\n\t\tdefaultMessage : \"You review has been submitted.\",\r\n\t\tid             : \"admin.review_submitted_successful\"\r\n\t},\r\n\treview     : {\r\n\t\tdefaultMessage : \"Write a review...\",\r\n\t\tid             : \"admin.textarea_review_placeholder\"\r\n\t},\r\n});\r\n\r\nclass MarketplaceRating extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.api = new ApiService();\r\n\r\n\t\tthis.state = {\r\n\t\t\tsubmitted : false,\r\n\t\t\tloading   : false,\r\n\t\t}\r\n\t}\r\n\r\n\tcanSubmitReview() {\r\n\t\tconst {trade, auth} = this.props;\r\n\t\tconst {submitted} = this.state;\r\n\t\tif (trade.status !== 'successful') return false;\r\n\r\n\t\tif (trade.buyer_id === auth.user.id) {\r\n\t\t\treturn trade.seller_rateable && !submitted;\r\n\t\t}\r\n\r\n\t\tif (trade.seller_id === auth.user.id) {\r\n\t\t\treturn trade.buyer_rateable && !submitted;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\thandleSubmit = (e) => {\r\n\t\te.preventDefault();\r\n\t\tconst {form, intl, trade} = this.props;\r\n\t\tconst {axios, route} = this.api;\r\n\t\tconst endpoint = route('chats.marketplace.submit-review', {\r\n\t\t\ttrade : trade.id\r\n\t\t});\r\n\t\tform.validateFields((errors, values) => {\r\n\t\t\tif (isEmpty(errors)) {\r\n\t\t\t\taxios.post(endpoint.url(), values)\r\n\t\t\t\t\t.then(response => handleFormSuccess(response, form, () => {\r\n\t\t\t\t\t\tthis.setState({loading : false, submitted : true});\r\n\t\t\t\t\t}, intl.formatMessage(messages.successful)))\r\n\r\n\t\t\t\t\t.catch(error => handleFormError(error, form, values, () => {\r\n\t\t\t\t\t\tthis.setState({loading : false});\r\n\t\t\t\t\t}));\r\n\r\n\t\t\t\tthis.setState({loading : true});\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tthis.api.cancel()\r\n\t}\r\n\r\n\trender() {\r\n\t\tif (!this.canSubmitReview()) return null;\r\n\r\n\t\tconst {intl, form} = this.props;\r\n\t\tconst {getFieldDecorator} = form;\r\n\t\tconst {loading} = this.state;\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"px-3\">\r\n\t\t\t\t<Comment\r\n\t\t\t\t\tcontent={\r\n\t\t\t\t\t\t<Form onSubmit={this.handleSubmit}>\r\n\t\t\t\t\t\t\t<Form.Item>\r\n\t\t\t\t\t\t\t\t{getFieldDecorator('comment', {\r\n\t\t\t\t\t\t\t\t\trules : [\r\n\t\t\t\t\t\t\t\t\t\t{type : 'string', required : true, min : 3, max : 200}\r\n\t\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t\t})(\r\n\t\t\t\t\t\t\t\t\t<TextArea style={{resize : 'none'}}\r\n\t\t\t\t\t\t\t\t\t          placeholder={intl.formatMessage(messages.review)}\r\n\t\t\t\t\t\t\t\t\t          rows={3}/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</Form.Item>\r\n\r\n\t\t\t\t\t\t\t<Form.Item className=\"d-flex align-items-center\">\r\n\t\t\t\t\t\t\t\t<span className=\"mr-2\">\r\n\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Rate\"\r\n\t\t\t\t\t\t\t\t\t\tid=\"common.rate\"/>:\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t{getFieldDecorator('rating', {\r\n\t\t\t\t\t\t\t\t\trules : [\r\n\t\t\t\t\t\t\t\t\t\t{type : 'number', required : true, min : 1, max : 5}\r\n\t\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t\t})(<Rate/>)}\r\n\t\t\t\t\t\t\t</Form.Item>\r\n\r\n\t\t\t\t\t\t\t<Form.Item>\r\n\t\t\t\t\t\t\t\t<Button htmlType=\"submit\" loading={loading}\r\n\t\t\t\t\t\t\t\t        className=\"mb-0\" shape=\"round\" type=\"primary\">\r\n\t\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Submit Review\"\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"marketplace.submit_review\"/>\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t</Form.Item>\r\n\t\t\t\t\t\t</Form>\r\n\t\t\t\t\t}/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = ({\r\n\tauth\r\n}) => ({\r\n\tauth : new Auth(auth)\r\n});\r\n\r\nexport default pipe(\r\n\tconnect(\r\n\t\tmapStateToProps\r\n\t),\r\n\tformHelper(),\r\n)(MarketplaceRating);","import React, {Component} from 'react';\r\nimport {Card} from \"antd\";\r\n\r\nclass PriceCard extends Component {\r\n\trender() {\r\n\t\tconst {styleName, name, price} = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<Card className={`${styleName} cp-card-price mb-0`}>\r\n\t\t\t\t<h6 className=\"text-muted\">\r\n\t\t\t\t\t{name}\r\n\t\t\t\t</h6>\r\n\t\t\t\t<h4 className=\"font-weight-medium\">\r\n\t\t\t\t\t{price}\r\n\t\t\t\t</h4>\r\n\t\t\t</Card>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default PriceCard;","import React, {Component} from 'react';\r\nimport {Button, Form, Input} from \"antd\";\r\nimport {defineMessages, FormattedMessage} from \"react-intl\";\r\nimport {pipe} from \"support/utils/common\";\r\nimport formHelper from \"support/Helpers/Form\";\r\nimport {isEmpty} from \"lodash\";\r\n\r\nconst messages = defineMessages({\r\n\ttwoFactorCode : {\r\n\t\tdefaultMessage : \"Enter your Two Factor code.\",\r\n\t\tid             : \"marketplace.input_two_factor_code_placeholder\"\r\n\t},\r\n\tpassword      : {\r\n\t\tdefaultMessage : \"Enter your Password.\",\r\n\t\tid             : \"marketplace.input_password_placeholder\"\r\n\t},\r\n});\r\n\r\nclass VerificationForm extends Component {\r\n\tcancel = () => {\r\n\t\tconst {onCancel} = this.props;\r\n\t\tif (typeof onCancel === \"function\") {\r\n\t\t\treturn onCancel();\r\n\t\t}\r\n\t};\r\n\r\n\tsubmit = () => {\r\n\t\tconst {form, onSubmit} = this.props;\r\n\t\tform.validateFields((errors, values) => {\r\n\t\t\tif (isEmpty(errors) && typeof onSubmit === \"function\") {\r\n\t\t\t\treturn onSubmit(values.code)\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst {withTwoFactor, intl} = this.props;\r\n\t\tconst {getFieldDecorator} = this.props.form;\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"p-2 text-left\">\r\n\t\t\t\t<Form>\r\n\t\t\t\t\t{withTwoFactor ? (\r\n\t\t\t\t\t\t<Form.Item labelAlign=\"left\"\r\n\t\t\t\t\t\t           label={\r\n\t\t\t\t\t\t\t           <FormattedMessage\r\n\t\t\t\t\t\t\t\t           defaultMessage=\"Token\"\r\n\t\t\t\t\t\t\t\t           id=\"marketplace.token\"/>\r\n\t\t\t\t\t\t           }>\r\n\t\t\t\t\t\t\t{getFieldDecorator('code', {\r\n\t\t\t\t\t\t\t\trules : [\r\n\t\t\t\t\t\t\t\t\t{required : true},\r\n\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t})(\r\n\t\t\t\t\t\t\t\t<Input placeholder={intl.formatMessage(messages.twoFactorCode)}/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Form.Item>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<Form.Item labelAlign=\"left\"\r\n\t\t\t\t\t\t           label={\r\n\t\t\t\t\t\t\t           <FormattedMessage\r\n\t\t\t\t\t\t\t\t           defaultMessage=\"Password\"\r\n\t\t\t\t\t\t\t\t           id=\"marketplace.password\"/>\r\n\t\t\t\t\t\t           }>\r\n\t\t\t\t\t\t\t{getFieldDecorator('code', {\r\n\t\t\t\t\t\t\t\trules : [\r\n\t\t\t\t\t\t\t\t\t{required : true},\r\n\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t})(\r\n\t\t\t\t\t\t\t\t<Input.Password placeholder={intl.formatMessage(messages.password)}/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Form.Item>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<Form.Item className=\"mt-2\">\r\n\t\t\t\t\t\t<Button type=\"primary\" block\r\n\t\t\t\t\t\t        onClick={this.submit}\r\n\t\t\t\t\t\t        className=\"mb-0\">\r\n\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\tdefaultMessage=\"Approve Trade\"\r\n\t\t\t\t\t\t\t\t\tid=\"marketplace.approve_trade\"/>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t<Button type=\"dashed\" block\r\n\t\t\t\t\t\t        onClick={this.cancel}>\r\n\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\tdefaultMessage=\"Cancel\"\r\n\t\t\t\t\t\t\t\t\tid=\"marketplace.cancel\"/>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Form.Item>\r\n\t\t\t\t</Form>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default pipe(\r\n\tformHelper(),\r\n)(VerificationForm);","import React, {Component} from 'react';\r\nimport {Button, Col, Divider, Icon, Modal, Popover, Row, Spin, Statistic, Tag} from \"antd\";\r\nimport {defineMessages, FormattedMessage, injectIntl} from \"react-intl\";\r\nimport {isEmpty, upperFirst} from \"lodash\";\r\nimport PriceCard from \"./components/PriceCard\";\r\nimport moment from \"moment\";\r\nimport ConfirmAction from \"components/ConfirmAction\";\r\nimport Auth from \"support/Auth\";\r\nimport {pipe} from \"support/utils/common\";\r\nimport {connect} from \"react-redux\";\r\nimport ApiService from \"support/Services/Api\";\r\nimport {handleError, handleSuccess} from \"support/utils/promise\";\r\nimport VerificationForm from \"./components/VerificationForm\";\r\n\r\nconst {Countdown} = Statistic;\r\n\r\nconst messages = defineMessages({\r\n\tapproved : {\r\n\t\tdefaultMessage : \"Trade has been approved.\",\r\n\t\tid             : \"chats.marketplace_approved_successful\"\r\n\t},\r\n\r\n\tdisputed : {\r\n\t\tdefaultMessage : \"A moderator will be in touch soon.\",\r\n\t\tid             : \"chats.marketplace_disputed_successful\"\r\n\t},\r\n\r\n\tcancelled : {\r\n\t\tdefaultMessage : \"Trade has been cancelled.\",\r\n\t\tid             : \"chats.marketplace_cancelled_successful\"\r\n\t},\r\n\r\n\tconfirmed : {\r\n\t\tdefaultMessage : \"Trade has been marked as paid.\",\r\n\t\tid             : \"chats.marketplace_confirmed_successful\"\r\n\t},\r\n});\r\n\r\nclass MarketplaceTrade extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.api = new ApiService();\r\n\r\n\t\tthis.state = {\r\n\t\t\tshowVerificationForm : false,\r\n\t\t\tloading              : false,\r\n\t\t}\r\n\t}\r\n\r\n\tonFinishCountDown = () => {\r\n\t\tthis.update();\r\n\t};\r\n\r\n\tshowInstructions = (trade) => {\r\n\t\tModal.info({\r\n\t\t\tcontent : (\r\n\t\t\t\t<p style={{whiteSpace : 'pre-line'}}>\r\n\t\t\t\t\t{trade.instructions}\r\n\t\t\t\t</p>\r\n\t\t\t)\r\n\t\t});\r\n\t};\r\n\r\n\tshowTerms = (trade) => {\r\n\t\tModal.info({\r\n\t\t\tcontent : (\r\n\t\t\t\t<p style={{whiteSpace : 'pre-line'}}>\r\n\t\t\t\t\t{trade.terms}\r\n\t\t\t\t</p>\r\n\t\t\t)\r\n\t\t});\r\n\t};\r\n\r\n\tupdate = () => {\r\n\t\tconst {onUpdate} = this.props;\r\n\t\tif (typeof onUpdate === \"function\") {\r\n\t\t\treturn onUpdate()\r\n\t\t}\r\n\t};\r\n\r\n\tcanApproveTrade = (trade) => {\r\n\t\tconst {auth} = this.props;\r\n\t\tif (!trade.confirmed_at) return false;\r\n\r\n\t\treturn this.isOnGoing(trade) && (\r\n\t\t\tauth.user.id === trade.seller.id ||\r\n\t\t\tthis.userCanManageTrade(trade)\r\n\t\t);\r\n\t};\r\n\r\n\tuserCanManageTrade(trade) {\r\n\t\tconst {auth} = this.props;\r\n\t\treturn auth.can('manage_marketplace') &&\r\n\t\t\t!this.userIsPartOfTrade(trade)\r\n\t}\r\n\r\n\tapprove = (trade, code) => {\r\n\t\tconst {axios, route} = this.api;\r\n\t\tconst {intl} = this.props;\r\n\r\n\t\tconst endpoint = route('chats.marketplace.approve', {\r\n\t\t\ttrade : trade.id\r\n\t\t});\r\n\r\n\t\tthis.setState({loading : true});\r\n\r\n\t\taxios.post(endpoint.url(), {code})\r\n\t\t\t.then(response => handleSuccess(response, () => {\r\n\t\t\t\tthis.setState({loading : false});\r\n\t\t\t\tthis.update();\r\n\t\t\t\tthis.toggleVerificationForm();\r\n\t\t\t}, intl.formatMessage(messages.approved)))\r\n\r\n\t\t\t.catch(error => handleError(error, () => {\r\n\t\t\t\tthis.setState({loading : false})\r\n\t\t\t}));\r\n\t};\r\n\r\n\tisOnGoing = (trade) => {\r\n\t\treturn !isEmpty(trade) && (\r\n\t\t\ttrade.status === \"active\" ||\r\n\t\t\ttrade.status === \"dispute\"\r\n\t\t);\r\n\t};\r\n\r\n\tcanConfirmTrade = (trade) => {\r\n\t\tconst {auth} = this.props;\r\n\t\tconst deadline = moment.utc(trade.cancels_at);\r\n\r\n\t\tif (trade.confirmed_at) return false;\r\n\t\tif (moment().isAfter(deadline.local())) return false;\r\n\t\tif (trade.status !== 'active') return false;\r\n\r\n\t\treturn auth.user.id === trade.buyer_id;\r\n\t};\r\n\r\n\tconfirm = (trade) => {\r\n\t\tconst {axios, route} = this.api;\r\n\t\tconst {intl} = this.props;\r\n\r\n\t\tconst endpoint = route('chats.marketplace.confirm', {\r\n\t\t\ttrade : trade.id\r\n\t\t});\r\n\t\tthis.setState({loading : true});\r\n\r\n\t\taxios.post(endpoint.url())\r\n\t\t\t.then(response => handleSuccess(response, () => {\r\n\t\t\t\tthis.setState({loading : false});\r\n\t\t\t\tthis.update();\r\n\t\t\t}, intl.formatMessage(messages.confirmed)))\r\n\r\n\t\t\t.catch(error => handleError(error, () => {\r\n\t\t\t\tthis.setState({loading : false});\r\n\t\t\t}));\r\n\t};\r\n\r\n\tcanCancelTrade = (trade) => {\r\n\t\tconst {auth} = this.props;\r\n\r\n\t\treturn this.isOnGoing(trade) && (\r\n\t\t\tthis.userCanManageTrade(trade) ||\r\n\t\t\tauth.user.id === trade.buyer_id\r\n\t\t);\r\n\t};\r\n\r\n\tcancel = (trade) => {\r\n\t\tconst {axios, route} = this.api;\r\n\t\tconst {intl} = this.props;\r\n\r\n\t\tconst endpoint = route('chats.marketplace.cancel', {\r\n\t\t\ttrade : trade.id\r\n\t\t});\r\n\t\tthis.setState({loading : true});\r\n\r\n\t\taxios.post(endpoint.url())\r\n\t\t\t.then(response => handleSuccess(response, (data) => {\r\n\t\t\t\tthis.setState({loading : false});\r\n\t\t\t\tthis.update();\r\n\t\t\t}, intl.formatMessage(messages.cancelled)))\r\n\r\n\t\t\t.catch(error => handleError(error, () => {\r\n\t\t\t\tthis.setState({loading : false})\r\n\t\t\t}));\r\n\r\n\t};\r\n\r\n\tcanDisputeTrade = (trade) => {\r\n\t\tif (!trade.confirmed_at) return false;\r\n\t\tif (trade.status !== 'active') return false;\r\n\r\n\t\tconst confirmedAt = moment.utc(trade.confirmed_at);\r\n\t\tconst createdAt = moment.utc(trade.created_at);\r\n\t\tconst cancelsAt = moment.utc(trade.cancels_at);\r\n\r\n\t\tconst disputableAfter = cancelsAt.diff(createdAt);\r\n\t\tconst timeElapsed = moment().diff(confirmedAt.local());\r\n\r\n\t\treturn timeElapsed > disputableAfter &&\r\n\t\t\tthis.userIsPartOfTrade(trade);\r\n\t};\r\n\r\n\tuserIsPartOfTrade(trade) {\r\n\t\tconst {auth} = this.props;\r\n\t\treturn (\r\n\t\t\tauth.user.id === trade.seller_id ||\r\n\t\t\tauth.user.id === trade.buyer_id\r\n\t\t)\r\n\t}\r\n\r\n\tdispute = (trade) => {\r\n\t\tconst {axios, route} = this.api;\r\n\t\tconst {intl} = this.props;\r\n\r\n\t\tconst endpoint = route('chats.marketplace.dispute', {\r\n\t\t\ttrade : trade.id\r\n\t\t});\r\n\t\tthis.setState({loading : true});\r\n\r\n\t\taxios.post(endpoint.url())\r\n\t\t\t.then(response => handleSuccess(response, (data) => {\r\n\t\t\t\tthis.setState({loading : false});\r\n\t\t\t\tthis.update();\r\n\t\t\t}, intl.formatMessage(messages.disputed)))\r\n\t\t\t.catch(error => handleError(error, () => {\r\n\t\t\t\tthis.setState({loading : false})\r\n\t\t\t}));\r\n\r\n\t};\r\n\r\n\tgetStatusColor = (status) => {\r\n\t\tswitch (status) {\r\n\t\t\tcase 'successful':\r\n\t\t\t\treturn \"#52c41a\";\r\n\t\t\tcase 'active':\r\n\t\t\t\treturn \"#2db7f5\";\r\n\t\t\tcase 'dispute':\r\n\t\t\t\treturn \"#faad14\";\r\n\t\t\tcase \"cancelled\":\r\n\t\t\t\treturn \"#f5222d\";\r\n\t\t\tdefault :\r\n\t\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\r\n\ttoggleVerificationForm = () => {\r\n\t\tthis.setState(({showVerificationForm}) => {\r\n\t\t\treturn {\r\n\t\t\t\tshowVerificationForm : !showVerificationForm\r\n\t\t\t};\r\n\t\t})\r\n\t};\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tthis.api.cancel();\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {trade, auth} = this.props;\r\n\t\tif (isEmpty(trade) || !this.isOnGoing(trade)) return null;\r\n\t\tconst {loading, showVerificationForm} = this.state;\r\n\r\n\t\tconst twoFactorSetting = auth.twoFactorSetting();\r\n\t\treturn (\r\n\t\t\t<Spin spinning={loading}>\r\n\t\t\t\t<div className=\"cp-trade pt-3\" key={trade.id}>\r\n\t\t\t\t\t<h3 className=\"text-center\">\r\n\t\t\t\t\t\t<span className=\"mr-2\">\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tdefaultMessage=\"Trade Status\"\r\n\t\t\t\t\t\t\t\tid=\"chats.trade_status\"/>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t<Tag color={this.getStatusColor(trade.status)}>\r\n\t\t\t\t\t\t\t\t{upperFirst(trade.status)}\r\n\t\t\t\t\t\t\t</Tag>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</h3>\r\n\r\n\t\t\t\t\t<Divider/>\r\n\r\n\t\t\t\t\t<div className=\"px-1\">\r\n\t\t\t\t\t\t<Row gutter={8}>\r\n\t\t\t\t\t\t\t<Col span={12}>\r\n\t\t\t\t\t\t\t\t<PriceCard\r\n\t\t\t\t\t\t\t\t\tprice={trade.formatted_amount_price}\r\n\t\t\t\t\t\t\t\t\tstyleName=\"mb-3\"\r\n\t\t\t\t\t\t\t\t\tname={\r\n\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Amount\"\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"common.amount\"/>\r\n\t\t\t\t\t\t\t\t\t}/>\r\n\t\t\t\t\t\t\t</Col>\r\n\r\n\t\t\t\t\t\t\t<Col span={12}>\r\n\t\t\t\t\t\t\t\t<PriceCard\r\n\t\t\t\t\t\t\t\t\tprice={trade.formatted_rate}\r\n\t\t\t\t\t\t\t\t\tstyleName=\"mb-3\"\r\n\t\t\t\t\t\t\t\t\tname={\r\n\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Rate\"\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"common.rate\"/>\r\n\t\t\t\t\t\t\t\t\t}/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Row>\r\n\r\n\t\t\t\t\t\t<Row gutter={8}>\r\n\t\t\t\t\t\t\t<Col span={12}>\r\n\t\t\t\t\t\t\t\t<PriceCard\r\n\t\t\t\t\t\t\t\t\tprice={trade.coin_name}\r\n\t\t\t\t\t\t\t\t\tname={\r\n\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Coin\"\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"common.coin\"/>\r\n\t\t\t\t\t\t\t\t\t}/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t<Col span={12}>\r\n\t\t\t\t\t\t\t\t<PriceCard\r\n\t\t\t\t\t\t\t\t\tprice={trade.formatted_fee_price}\r\n\t\t\t\t\t\t\t\t\tname={\r\n\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Fee\"\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"common.fee\"/>\r\n\t\t\t\t\t\t\t\t\t}/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{!trade.confirmed_at && (\r\n\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t<Divider/>\r\n\r\n\t\t\t\t\t\t\t<div className=\"text-center\">\r\n\t\t\t\t\t\t\t\t<Countdown\r\n\t\t\t\t\t\t\t\t\tonFinish={this.onFinishCountDown}\r\n\t\t\t\t\t\t\t\t\tvalue={moment.utc(trade.cancels_at).local()}\r\n\t\t\t\t\t\t\t\t\ttitle={\r\n\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Payment Deadline\"\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"common.payment_deadline\"/>\r\n\t\t\t\t\t\t\t\t\t}/>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<Divider/>\r\n\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<div className=\"my-3 text-center w-100\">\r\n\t\t\t\t\t\t{this.canApproveTrade(trade) && (\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t{showVerificationForm ? (\r\n\t\t\t\t\t\t\t\t\t<VerificationForm\r\n\t\t\t\t\t\t\t\t\t\tonSubmit={(code) => this.approve(trade, code)}\r\n\t\t\t\t\t\t\t\t\t\tonCancel={this.toggleVerificationForm}\r\n\t\t\t\t\t\t\t\t\t\twithTwoFactor={twoFactorSetting.marketplace()}/>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<Button type=\"default\" shape=\"round\"\r\n\t\t\t\t\t\t\t\t\t        onClick={this.toggleVerificationForm}\r\n\t\t\t\t\t\t\t\t\t        className=\"mx-0 mb-2 cp-btn-success\"\r\n\t\t\t\t\t\t\t\t\t        icon=\"check-circle\" size=\"small\">\r\n\t\t\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Release Coin\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"trade.release_coin\"/>\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{this.canConfirmTrade(trade) && (\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<ConfirmAction\r\n\t\t\t\t\t\t\t\t\tonConfirm={() => this.confirm(trade)}\r\n\t\t\t\t\t\t\t\t\ttitle={\r\n\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Are you sure you want to {action}?\"\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"trade.mark_trade_as_paid_confirmation\"\r\n\t\t\t\t\t\t\t\t\t\t\tvalues={{\r\n\t\t\t\t\t\t\t\t\t\t\t\taction : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<b>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Mark Trade as Paid\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"trade.mark_trade_as_paid\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</b>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t}}/>\r\n\t\t\t\t\t\t\t\t\t}>\r\n\t\t\t\t\t\t\t\t\t<Button type=\"default\"\r\n\t\t\t\t\t\t\t\t\t        icon=\"check\" size=\"small\"\r\n\t\t\t\t\t\t\t\t\t        className=\"mx-0 mb-2\"\r\n\t\t\t\t\t\t\t\t\t        shape=\"round\">\r\n\t\t\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Mark Trade as Paid\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"trade.mark_trade_as_paid\"/>\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t</ConfirmAction>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{this.canCancelTrade(trade) && (\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<ConfirmAction\r\n\t\t\t\t\t\t\t\t\tonConfirm={() => this.cancel(trade)}\r\n\t\t\t\t\t\t\t\t\ttitle={\r\n\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Are you sure you want to {action}?\"\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"offer.cancel_trade_confirmation\"\r\n\t\t\t\t\t\t\t\t\t\t\tvalues={{\r\n\t\t\t\t\t\t\t\t\t\t\t\taction : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<b>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Cancel Trade\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"trade.cancel_trade\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</b>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t}}/>\r\n\t\t\t\t\t\t\t\t\t}>\r\n\t\t\t\t\t\t\t\t\t<Button type=\"default\" shape=\"round\"\r\n\t\t\t\t\t\t\t\t\t        className=\"cp-btn-danger mx-0 mb-2\"\r\n\t\t\t\t\t\t\t\t\t        icon=\"close-circle\" size=\"small\">\r\n\t\t\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Cancel Trade\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"trade.cancel_trade\"/>\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t</ConfirmAction>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\r\n\r\n\t\t\t\t\t\t{this.canDisputeTrade(trade) && (\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<ConfirmAction\r\n\t\t\t\t\t\t\t\t\tonConfirm={() => this.dispute(trade)}\r\n\t\t\t\t\t\t\t\t\ttitle={\r\n\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Are you sure you want to {action}?\"\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"offer.raise_dispute_confirmation\"\r\n\t\t\t\t\t\t\t\t\t\t\tvalues={{\r\n\t\t\t\t\t\t\t\t\t\t\t\taction : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<b>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Raise Dispute\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"trade.raise_dispute\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</b>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t}}/>\r\n\t\t\t\t\t\t\t\t\t}>\r\n\r\n\t\t\t\t\t\t\t\t\t<Button type=\"default\" shape=\"round\"\r\n\t\t\t\t\t\t\t\t\t        className=\"cp-btn-warning mx-0 mb-2\"\r\n\t\t\t\t\t\t\t\t\t        icon=\"flag\" size=\"small\">\r\n\t\t\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Raise Dispute\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"trade.raise_dispute\"/>\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t</ConfirmAction>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<Divider/>\r\n\r\n\t\t\t\t\t<div className=\"px-2 mb-3 text-center\">\r\n\t\t\t\t\t\t<h5 className=\"mb-2\">\r\n\t\t\t\t\t\t\t<a className=\"mr-2\" onClick={() => this.showTerms(trade)}>\r\n\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\tdefaultMessage=\"Terms\"\r\n\t\t\t\t\t\t\t\t\tid=\"common.terms\"/>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t<span className=\"mr-2\">\r\n\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\tdefaultMessage=\"and\"\r\n\t\t\t\t\t\t\t\t\tid=\"common.and\"/>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t<a className=\"mr-2\" onClick={() => this.showInstructions(trade)}>\r\n\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\tdefaultMessage=\"Instructions\"\r\n\t\t\t\t\t\t\t\t\tid=\"common.instruction\"/>\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t</h5>\r\n\r\n\t\t\t\t\t\t<h5 className=\"mb-2\">\r\n\t\t\t\t\t\t\t<span className=\"mr-2\">\r\n\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\tdefaultMessage={\r\n\t\t\t\t\t\t\t\t\t\t\"{buyer} to pay {offerAmount} to {seller}\"\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tvalues={{\r\n\t\t\t\t\t\t\t\t\t\tseller      : <b>{trade.seller.name}</b>,\r\n\t\t\t\t\t\t\t\t\t\tofferAmount : <b>{trade.formatted_offer_amount}</b>,\r\n\t\t\t\t\t\t\t\t\t\tbuyer       : <b>{trade.buyer.name}</b>,\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\tid=\"chats.trade_payment_instruction\"/>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</h5>\r\n\r\n\t\t\t\t\t\t<h5>\r\n\t\t\t\t\t\t\t<span className=\"mr-2\">\r\n\t\t\t\t\t\t\t\t{trade.payment_method_name}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t{trade.payment_method_description && (\r\n\t\t\t\t\t\t\t\t<Popover overlayStyle={{maxWidth : 250}}\r\n\t\t\t\t\t\t\t\t         content={trade.payment_method_description}\r\n\t\t\t\t\t\t\t\t         title={\r\n\t\t\t\t\t\t\t\t\t         <FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t         id=\"common.payment_method_description\"\r\n\t\t\t\t\t\t\t\t\t\t         defaultMessage=\"Description\"/>\r\n\t\t\t\t\t\t\t\t         }\r\n\t\t\t\t\t\t\t\t         trigger=\"click\">\r\n\t\t\t\t\t\t\t\t\t<Icon type=\"question-circle\" theme=\"filled\"/>\r\n\t\t\t\t\t\t\t\t</Popover>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</h5>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<Divider/>\r\n\t\t\t\t</div>\r\n\t\t\t</Spin>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = ({\r\n\tauth\r\n}) => ({\r\n\tauth : new Auth(auth)\r\n});\r\n\r\nexport default pipe(\r\n\tconnect(\r\n\t\tmapStateToProps\r\n\t),\r\n\tinjectIntl,\r\n)(MarketplaceTrade);","import React, {Component} from 'react';\r\nimport UserAvatar from \"components/UserAvatar\";\r\nimport {utcDateCalendarTime} from \"support/utils/common\";\r\nimport {isEmpty} from \"lodash\";\r\nimport {FormattedMessage} from \"react-intl\";\r\nimport {Link} from \"react-router-dom\";\r\n\r\nclass TextCell extends Component {\r\n\tgetUserAvatar = () => {\r\n\t\tconst {message} = this.props;\r\n\t\tconst user = message.user;\r\n\t\treturn (\r\n\t\t\t<Link to={`/profile/${user.name}`}>\r\n\t\t\t\t<UserAvatar\r\n\t\t\t\t\tclassName=\"align-self-end\"\r\n\t\t\t\t\tuser={user} size={40}/>\r\n\t\t\t</Link>\r\n\t\t)\r\n\t};\r\n\r\n\tgetTextDetail = () => {\r\n\t\tconst {message} = this.props;\r\n\t\tif (isEmpty(message.text)) {\r\n\t\t\treturn (\r\n\t\t\t\t<span>\r\n\t\t\t\t\t<i className=\"la la-ban mr-1\"/>\r\n\t\t\t\t\t<span>\r\n\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\tdefaultMessage=\"Message Deleted\"\r\n\t\t\t\t\t\t\tid=\"chats.message_deleted\"/>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</span>\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn (\r\n\t\t\t\t<span>\r\n\t\t\t\t\t{message.text.body}\r\n\t\t\t\t</span>\r\n\t\t\t)\r\n\t\t}\r\n\t};\r\n\r\n\tgetTimestamp = () => {\r\n\t\tconst {message} = this.props;\r\n\t\treturn message.created_at && (\r\n\t\t\t<small className=\"text-muted\">\r\n\t\t\t\t{utcDateCalendarTime(message.created_at)}\r\n\t\t\t</small>\r\n\t\t);\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst {mode} = this.props;\r\n\r\n\t\tconst itemClass = (mode === 'right') ?\r\n\t\t\t\"cp-chat-item flex-row-reverse\" : \"cp-chat-item\";\r\n\r\n\t\treturn (\r\n\t\t\t<div className={itemClass}>\r\n\t\t\t\t{this.getUserAvatar()}\r\n\r\n\t\t\t\t<div className=\"cp-bubble-block\">\r\n\t\t\t\t\t<div className=\"cp-bubble d-inline-block\">\r\n\t\t\t\t\t\t<div className=\"cp-message mb-2\">\r\n\t\t\t\t\t\t\t{this.getTextDetail()}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"cp-time text-right\">\r\n\t\t\t\t\t\t\t{this.getTimestamp()}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\nexport default TextCell;","import React, {Component} from 'react';\r\nimport Auth from \"support/Auth\";\r\nimport {pipe, sortDate} from \"support/utils/common\";\r\nimport {connect} from \"react-redux\";\r\nimport {defineMessages, FormattedMessage, injectIntl} from \"react-intl\";\r\nimport {handleError, handleSuccess} from \"support/utils/promise\";\r\nimport ApiService, {uploadRequest} from \"support/Services/Api\";\r\nimport {find, has, isEmpty, uniqBy} from \"lodash\";\r\nimport Loading from \"components/Loading\";\r\nimport {Avatar, Col, Drawer, Icon, Input, List, message as messageApi, Row, Spin, Upload} from \"antd\";\r\nimport UserAvatar from \"components/UserAvatar\";\r\nimport ChatNotFound from \"./components/ChatNotFound\";\r\nimport TextCell from \"./components/TextCell\";\r\nimport Pagination from \"support/Helpers/Pagination\";\r\nimport SimpleBar from \"simplebar\";\r\nimport InfiniteScroll from \"react-infinite-scroller\";\r\nimport ActivityCell from \"./components/ActivityCell\";\r\nimport AttachmentCell from \"./components/AttachmentCell\";\r\nimport PrivateBroadcast from \"support/Services/Broadcast/Private\";\r\nimport MarketplaceTrade from \"./components/MarketplaceTrade\";\r\nimport MarketplaceRating from \"./components/MarketplaceRating\";\r\nimport {Link} from \"react-router-dom\";\r\n\r\nconst {TextArea} = Input;\r\n\r\nconst messages = defineMessages({\r\n\tinputMessage : {\r\n\t\tdefaultMessage : \"Type a message...\",\r\n\t\tid             : \"chats.input_message_placeholder\"\r\n\t},\r\n});\r\n\r\nclass Body extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.broadcast = new PrivateBroadcast();\r\n\t\tthis.api = new ApiService();\r\n\r\n\t\tthis.state = {\r\n\t\t\tchat                        : {},\r\n\t\t\tloadingChat                 : false,\r\n\t\t\tdata                        : [],\r\n\t\t\thasMore                     : false,\r\n\t\t\tparams                      : {\r\n\t\t\t\ttotal    : 0,\r\n\t\t\t\tpageSize : 40,\r\n\t\t\t\tcurrent  : 1\r\n\t\t\t},\r\n\t\t\tmarketplaceTrade            : {},\r\n\t\t\tmarketplaceTradeDrawerState : false,\r\n\t\t\tloading                     : false,\r\n\t\t\tloadingMore                 : false,\r\n\t\t\ttext                        : \"\",\r\n\t\t\tsendingAttachment           : false,\r\n\t\t\tsendingText                 : false,\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.fetchChat();\r\n\t}\r\n\r\n\tresetBroadcastChannel() {\r\n\t\tconst {chat} = this.state;\r\n\t\tif (!isEmpty(chat)) {\r\n\t\t\tthis.broadcast.setChannel('App.Chat.' + chat.id)\r\n\t\t} else {\r\n\t\t\tthis.broadcast.unbind();\r\n\t\t}\r\n\t}\r\n\r\n\tfetchMarketplaceTrade() {\r\n\t\tconst {chat} = this.state;\r\n\t\tif (isEmpty(chat) || !chat.id) return;\r\n\t\tconst {axios, route} = this.api;\r\n\r\n\t\tconst endpoint = route('chats.latest-marketplace-trade', {\r\n\t\t\tchat : chat.id\r\n\t\t});\r\n\r\n\t\taxios.post(endpoint.url())\r\n\t\t\t.then(response => handleSuccess(response, (data) => {\r\n\t\t\t\tthis.setState({marketplaceTrade : data}, () => {\r\n\t\t\t\t\tthis.scrollToBottom();\r\n\t\t\t\t});\r\n\t\t\t}))\r\n\t\t\t.catch(error => handleError(error));\r\n\t}\r\n\r\n\tbindBroadcastEvents() {\r\n\t\tthis.resetBroadcastChannel();\r\n\t\tthis.broadcast.listen('MarketplaceTradeSaved', this.marketplaceTradeSavedListener);\r\n\t\tthis.broadcast.listen('NewChatMessage', this.newChatMessageListener);\r\n\t}\r\n\r\n\tmarketplaceTradeSavedListener = (e) => {\r\n\t\tthis.fetchMarketplaceTrade();\r\n\t};\r\n\r\n\tnewChatMessageListener = (e) => {\r\n\t\tconst {auth} = this.props;\r\n\t\tif (isEmpty(e.message)) return;\r\n\t\tconst message = e.message;\r\n\r\n\t\tif (message.user_id !== auth.user.id) {\r\n\t\t\tthis.updateParticipation(message.chat_id);\r\n\t\t}\r\n\r\n\t\tthis.setState(({data}) => {\r\n\t\t\treturn {\r\n\t\t\t\tdata : this.sortMessages(data.concat(message))\r\n\t\t\t}\r\n\t\t}, () => {\r\n\t\t\tthis.scrollToBottom();\r\n\t\t});\r\n\t};\r\n\r\n\tonMarketplaceTradeUpdate = () => {\r\n\t\tthis.toggleMarketplaceTradeDrawer();\r\n\t\tthis.fetchMarketplaceTrade();\r\n\t};\r\n\r\n\tupdateParticipation = (chatId) => {\r\n\t\tconst {axios, route} = this.api;\r\n\t\tif (!chatId) return;\r\n\r\n\t\tconst endpoint = route('chats.update-participation', {\r\n\t\t\tchat : chatId\r\n\t\t});\r\n\r\n\t\taxios.post(endpoint.url())\r\n\t\t\t.then(response => handleSuccess(response))\r\n\t\t\t.catch(error => handleError(error));\r\n\t};\r\n\r\n\tscrollToBottom() {\r\n\t\tconst container = this.scrollParent;\r\n\t\tif (container) {\r\n\t\t\tcontainer.scrollTop = container.scrollHeight;\r\n\t\t}\r\n\t};\r\n\r\n\tcanSendMessage() {\r\n\t\treturn (\r\n\t\t\t!isEmpty(this.state.chat) &&\r\n\t\t\t!this.state.sendingAttachment &&\r\n\t\t\t!this.state.sendingText &&\r\n\t\t\tthis.showMarketplaceTrades()\r\n\t\t)\r\n\t};\r\n\r\n\tsendText = () => {\r\n\t\tconst {chat, text} = this.state;\r\n\t\tif (!text || !this.canSendMessage()) return;\r\n\t\tconst {axios, route} = this.api;\r\n\r\n\t\tconst endpoint = route('chats.messages.save-text', {\r\n\t\t\tchat : chat.id\r\n\t\t});\r\n\r\n\t\taxios.post(endpoint.url(), {body : text})\r\n\t\t\t.then(response => handleSuccess(response, () => {\r\n\t\t\t\tthis.setState({sendingText : false});\r\n\t\t\t}))\r\n\t\t\t.catch(error => handleError(error, () => {\r\n\t\t\t\tthis.setState({sendingText : false});\r\n\t\t\t}));\r\n\r\n\t\tthis.setState({sendingText : true, text : \"\"}, () => {\r\n\t\t\tthis.scrollToBottom();\r\n\t\t});\r\n\t};\r\n\r\n\tbeforeUpload = (file) => {\r\n\t\tconst status = this.canSendMessage();\r\n\t\tthis.setState({\r\n\t\t\tsendingAttachment : status\r\n\t\t}, () => {\r\n\t\t\tif (status) this.scrollToBottom();\r\n\t\t});\r\n\t\treturn status;\r\n\t};\r\n\r\n\thandleUploadSuccess = (message) => {\r\n\t\tthis.setState(({data}) => {\r\n\t\t\treturn {\r\n\t\t\t\tsendingAttachment : false,\r\n\t\t\t\tdata              : this.sortMessages(data.concat(message)),\r\n\t\t\t}\r\n\t\t}, () => {\r\n\t\t\tthis.scrollToBottom();\r\n\t\t});\r\n\t};\r\n\r\n\thandleUploadError = (errors) => {\r\n\t\tif (has(errors, 'file')) {\r\n\t\t\terrors.file.forEach(error => messageApi.error(error));\r\n\t\t}\r\n\t};\r\n\r\n\tfetchMessages = () => {\r\n\t\tconst {filters, chat, params} = this.state;\r\n\t\tconst nextParams = {...params, current : 1};\r\n\r\n\t\tif (isEmpty(chat) || !chat.id) return;\r\n\r\n\t\tconst endpoint = this.api.route('chats.messages.table', {\r\n\t\t\tchat : chat.id\r\n\t\t}).url();\r\n\t\tthis.mesagePagination = new Pagination(this.api, endpoint);\r\n\r\n\t\tthis.setState({loading : true, data : []});\r\n\r\n\t\tthis.mesagePagination.fetchData(\r\n\t\t\tnextParams, filters, (page) => {\r\n\t\t\t\tconst nextHasMore = Boolean(page.links.next);\r\n\r\n\t\t\t\tthis.setState(() => {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tdata    : this.sortMessages(page.data),\r\n\t\t\t\t\t\tloading : false,\r\n\t\t\t\t\t\thasMore : false,\r\n\t\t\t\t\t\tparams  : {\r\n\t\t\t\t\t\t\t...nextParams, total : page.meta.total\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t}, () => {\r\n\t\t\t\t\tconst element = this.scrollParent;\r\n\t\t\t\t\tif (typeof element !== \"undefined\") {\r\n\t\t\t\t\t\telement.scrollTop = element.scrollHeight;\r\n\t\t\t\t\t\tthis.setState({hasMore : nextHasMore});\r\n\t\t\t\t\t\tconsole.log('Showing Latest Messages')\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.setState({loading : false})\r\n\t\t\t}\r\n\t\t);\r\n\t};\r\n\r\n\tsortMessages = (messages) => {\r\n\t\tif (!Array.isArray(messages)) return messages;\r\n\t\tmessages = messages.sort((a, b) => sortDate(a.created_at, b.created_at));\r\n\t\treturn uniqBy(messages, 'id');\r\n\t};\r\n\r\n\tcanLoadMoreMessages() {\r\n\t\tconst {hasMore, loadingMore, loading} = this.state;\r\n\t\treturn (hasMore && !loadingMore && !loading);\r\n\t}\r\n\r\n\tonLoadMore = () => {\r\n\t\tif (!this.canLoadMoreMessages()) return;\r\n\r\n\t\tconst {params, filters} = this.state;\r\n\t\tlet nextParams = {...params, current : params.current + 1};\r\n\r\n\t\tthis.mesagePagination.fetchData(\r\n\t\t\tnextParams, filters, (page) => {\r\n\t\t\t\tthis.setState(({data}) => {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tdata        : this.sortMessages(data.concat(page.data)),\r\n\t\t\t\t\t\tparams      : {...nextParams, total : page.meta.total},\r\n\t\t\t\t\t\tloadingMore : false,\r\n\t\t\t\t\t\thasMore     : Boolean(page.links.next),\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.setState({loadingMore : false})\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tthis.setState({loadingMore : true});\r\n\t};\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tthis.broadcast.unbind();\r\n\t\tthis.api.cancel();\r\n\t}\r\n\r\n\tfetchChat() {\r\n\t\tconst {axios, route} = this.api;\r\n\t\tconst activeChat = this.props.activeChat;\r\n\t\tif (isEmpty(activeChat)) return;\r\n\r\n\t\tconst endpoint = route('chats.get', {\r\n\t\t\tchat : activeChat.token\r\n\t\t});\r\n\r\n\t\taxios.post(endpoint.url())\r\n\t\t\t.then(response => handleSuccess(response, (data) => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\tloadingChat : false, chat : data\r\n\t\t\t\t}, () => {\r\n\t\t\t\t\tthis.fetchMessages();\r\n\t\t\t\t\tthis.fetchMarketplaceTrade();\r\n\t\t\t\t\tthis.updateParticipation(data.id);\r\n\t\t\t\t\tthis.bindBroadcastEvents();\r\n\t\t\t\t});\r\n\t\t\t}))\r\n\t\t\t.catch(error => handleError(error, () => {\r\n\t\t\t\tthis.setState({loadingChat : false});\r\n\t\t\t}));\r\n\r\n\t\tthis.setState({loadingChat : true, chat : {}});\r\n\t}\r\n\r\n\tgetHighlightedParticipant() {\r\n\t\tif (isEmpty(this.highlightedParticpant)) {\r\n\t\t\tconst chat = this.state.chat;\r\n\t\t\tconst auth = this.props.auth;\r\n\t\t\tconst participants = chat.participants;\r\n\r\n\t\t\tthis.highlightedParticpant = find(participants, function (o) {\r\n\t\t\t\treturn !isEmpty(o.user) &&\r\n\t\t\t\t\to.user.id !== auth.user.id;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn this.highlightedParticpant;\r\n\t}\r\n\r\n\tgetUserAvatar = () => {\r\n\t\tconst participant = this.getHighlightedParticipant();\r\n\r\n\t\tif (!isEmpty(participant)) {\r\n\t\t\treturn (\r\n\t\t\t\t<UserAvatar\r\n\t\t\t\t\tshowPresence={false}\r\n\t\t\t\t\tuser={participant.user}\r\n\t\t\t\t\tsize={40}/>\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\treturn (\r\n\t\t\t\t<Avatar icon=\"message\"\r\n\t\t\t\t        size={40}/>\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\r\n\tgetChatTitle() {\r\n\t\tconst {chat} = this.state;\r\n\t\tconst participant = this.getHighlightedParticipant();\r\n\t\tconst participants = chat.participants;\r\n\r\n\t\tif (!isEmpty(participant)) {\r\n\t\t\tconst profileLink = (\r\n\t\t\t\t<Link to={`/profile/${participant.user.name}`}>\r\n\t\t\t\t\t{participant.user.name}\r\n\t\t\t\t</Link>\r\n\t\t\t);\r\n\r\n\t\t\tif (participants.length > 1) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tdefaultMessage=\"{user} and {total} other(s)\"\r\n\t\t\t\t\t\tid=\"chats.view_title\"\r\n\t\t\t\t\t\tvalues={{\r\n\t\t\t\t\t\t\ttotal : (participants.length - 1),\r\n\t\t\t\t\t\t\tuser  : profileLink\r\n\t\t\t\t\t\t}}/>\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\treturn profileLink;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn (\r\n\t\t\t\t<FormattedMessage\r\n\t\t\t\t\tdefaultMessage=\"You and {total} other(s)\"\r\n\t\t\t\t\tid=\"chats.default_title\"\r\n\t\t\t\t\tvalues={{\r\n\t\t\t\t\t\ttotal : participants.length\r\n\t\t\t\t\t}}/>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tonChangeText = (e) => {\r\n\t\tthis.setState({text : e.target.value})\r\n\t};\r\n\r\n\thandleTextKeyUp = (e) => {\r\n\t\tif (e.key === 'Enter') this.sendText();\r\n\t};\r\n\r\n\ttoggleMarketplaceTradeDrawer = () => {\r\n\t\tthis.changeFullscreen(false);\r\n\t\tthis.setState(({marketplaceTradeDrawerState}) => {\r\n\t\t\treturn {\r\n\t\t\t\tmarketplaceTradeDrawerState : !marketplaceTradeDrawerState,\r\n\t\t\t};\r\n\t\t});\r\n\t};\r\n\r\n\tchangeFullscreen(fullscreen) {\r\n\t\tconst {onChangeFullscreen} = this.props;\r\n\t\tif (typeof onChangeFullscreen === \"function\") {\r\n\t\t\treturn onChangeFullscreen(fullscreen);\r\n\t\t}\r\n\t}\r\n\r\n\tsetScrollWrapper = (ref) => {\r\n\t\tif (ref !== this.scrollWrapper && ref !== null) {\r\n\t\t\tconst simpleBar = new SimpleBar(ref);\r\n\t\t\tthis.scrollParent = simpleBar.getScrollElement();\r\n\t\t\tthis.scrollWrapper = ref\r\n\t\t}\r\n\t};\r\n\r\n\tgetStatusColor = (status) => {\r\n\t\tswitch (status) {\r\n\t\t\tcase 'successful':\r\n\t\t\t\treturn \"#52c41a\";\r\n\t\t\tcase 'active':\r\n\t\t\t\treturn \"#2db7f5\";\r\n\t\t\tcase 'dispute':\r\n\t\t\t\treturn \"#faad14\";\r\n\t\t\tcase \"cancelled\":\r\n\t\t\t\treturn \"#f5222d\";\r\n\t\t\tdefault :\r\n\t\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\r\n\tshowMarketplaceTrades() {\r\n\t\tconst {marketplaceTrade} = this.state;\r\n\t\treturn !isEmpty(marketplaceTrade) && (\r\n\t\t\tmarketplaceTrade.status === \"active\" ||\r\n\t\t\tmarketplaceTrade.status === \"dispute\"\r\n\t\t)\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tchat, data, text, marketplaceTrade,\r\n\t\t\tloadingChat, loading, loadingMore, hasMore,\r\n\t\t\tmarketplaceTradeDrawerState\r\n\t\t} = this.state;\r\n\r\n\t\tconst {\r\n\t\t\tauth, intl, fullscreen,\r\n\t\t\tonToggleFullscreen, onToggleDrawer\r\n\t\t} = this.props;\r\n\r\n\t\tif (!isEmpty(chat)) {\r\n\t\t\tconst uploadEndpoint = this.api.route('chats.messages.save-attachment', {\r\n\t\t\t\tchat : chat.id\r\n\t\t\t});\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<div className=\"cp-chat-main animated fadeIn\">\r\n\t\t\t\t\t<div className=\"cp-chat-main-header\">\r\n\t\t\t\t\t\t<span className=\"d-block d-lg-none cp-chat-btn\">\r\n\t\t\t\t\t\t\t<i className=\"cp-icon-btn la la-comments\"\r\n\t\t\t\t\t\t\t   onClick={onToggleDrawer}/>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<div className=\"cp-chat-main-header-info\">\r\n\t\t\t\t\t\t\t<div className=\"cp-chat-avatar mr-2 d-none d-sm-block\">\r\n\t\t\t\t\t\t\t\t{this.getUserAvatar()}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div className=\"cp-chat-contact-name\">\r\n\t\t\t\t\t\t\t\t{this.getChatTitle()}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{this.showMarketplaceTrades() && (\r\n\t\t\t\t\t\t\t<Icon onClick={this.toggleMarketplaceTradeDrawer}\r\n\t\t\t\t\t\t\t      type=\"dollar-circle\" theme=\"filled\"\r\n\t\t\t\t\t\t\t      className=\"animated flash infinite slow mr-2 cp-fs-2x cp-icon-btn\"\r\n\t\t\t\t\t\t\t      style={{\r\n\t\t\t\t\t\t\t\t      color : this.getStatusColor(marketplaceTrade.status)\r\n\t\t\t\t\t\t\t      }}/>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{fullscreen ? (\r\n\t\t\t\t\t\t\t<i className=\"cp-icon-btn la la-compress ml-2 cp-fs-2x\"\r\n\t\t\t\t\t\t\t   onClick={onToggleFullscreen}/>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<i className=\"cp-icon-btn la la-expand ml-2 cp-fs-2x\"\r\n\t\t\t\t\t\t\t   onClick={onToggleFullscreen}/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{this.showMarketplaceTrades() && (\r\n\t\t\t\t\t\t<Drawer visible={marketplaceTradeDrawerState}\r\n\t\t\t\t\t\t        closable={false}\r\n\t\t\t\t\t\t        width={320}\r\n\t\t\t\t\t\t        onClose={this.toggleMarketplaceTradeDrawer}\r\n\t\t\t\t\t\t        placement=\"right\">\r\n\t\t\t\t\t\t\t<MarketplaceTrade\r\n\t\t\t\t\t\t\t\tonUpdate={this.onMarketplaceTradeUpdate}\r\n\t\t\t\t\t\t\t\ttrade={marketplaceTrade}/>\r\n\t\t\t\t\t\t</Drawer>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<Spin spinning={loading}>\r\n\t\t\t\t\t\t<div ref={this.setScrollWrapper}\r\n\t\t\t\t\t\t     className=\"cp-chat-list-scroll\"\r\n\t\t\t\t\t\t     data-simplebar={true}>\r\n\t\t\t\t\t\t\t<InfiniteScroll useWindow={false}\r\n\t\t\t\t\t\t\t                loadMore={this.onLoadMore}\r\n\t\t\t\t\t\t\t                getScrollParent={() => this.scrollParent}\r\n\t\t\t\t\t\t\t                isReverse={true}\r\n\t\t\t\t\t\t\t                hasMore={!loadingMore && hasMore}\r\n\t\t\t\t\t\t\t                pageStart={1}\r\n\t\t\t\t\t\t\t                initialLoad={false}>\r\n\t\t\t\t\t\t\t\t{loadingMore && <Loading/>}\r\n\r\n\t\t\t\t\t\t\t\t<List dataSource={data}\r\n\t\t\t\t\t\t\t\t      rowKey={(record) => record.id}\r\n\t\t\t\t\t\t\t\t      renderItem={item => {\r\n\t\t\t\t\t\t\t\t\t      const isOwner = (item.user_id === auth.user.id);\r\n\r\n\t\t\t\t\t\t\t\t\t      switch (item.type) {\r\n\t\t\t\t\t\t\t\t\t\t      case 'text':\r\n\t\t\t\t\t\t\t\t\t\t\t      return (\r\n\t\t\t\t\t\t\t\t\t\t\t\t      <TextCell\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t      mode={isOwner ? 'right' : 'left'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t      message={item}/>\r\n\t\t\t\t\t\t\t\t\t\t\t      );\r\n\t\t\t\t\t\t\t\t\t\t      case 'attachment':\r\n\t\t\t\t\t\t\t\t\t\t\t      return (\r\n\t\t\t\t\t\t\t\t\t\t\t\t      <AttachmentCell\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t      mode={isOwner ? 'right' : 'left'}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t      message={item}/>\r\n\t\t\t\t\t\t\t\t\t\t\t      );\r\n\t\t\t\t\t\t\t\t\t\t      case 'activity':\r\n\t\t\t\t\t\t\t\t\t\t\t      return (\r\n\t\t\t\t\t\t\t\t\t\t\t\t      <ActivityCell\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t      message={item}/>\r\n\t\t\t\t\t\t\t\t\t\t\t      );\r\n\t\t\t\t\t\t\t\t\t\t      default:\r\n\t\t\t\t\t\t\t\t\t\t\t      return <List.Item/>\r\n\t\t\t\t\t\t\t\t\t      }\r\n\t\t\t\t\t\t\t\t      }}/>\r\n\t\t\t\t\t\t\t\t<MarketplaceRating\r\n\t\t\t\t\t\t\t\t\ttrade={marketplaceTrade}/>\r\n\t\t\t\t\t\t\t</InfiniteScroll>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</Spin>\r\n\r\n\t\t\t\t\t<div className=\"cp-chat-main-footer\">\r\n\t\t\t\t\t\t<Row gutter={8} className=\"d-flex align-items-center\">\r\n\t\t\t\t\t\t\t<Col xs={18} sm={20}>\r\n\t\t\t\t\t\t\t\t<TextArea onKeyUp={this.handleTextKeyUp}\r\n\t\t\t\t\t\t\t\t          placeholder={intl.formatMessage(messages.inputMessage)}\r\n\t\t\t\t\t\t\t\t          rows={2} value={text}\r\n\t\t\t\t\t\t\t\t          disabled={!this.canSendMessage()}\r\n\t\t\t\t\t\t\t\t          autoFocus={true}\r\n\t\t\t\t\t\t\t\t          style={{maxHeight : '48px', resize : 'none'}}\r\n\t\t\t\t\t\t\t\t          onChange={this.onChangeText}/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t<Col xs={6} sm={4}>\r\n\t\t\t\t\t\t\t\t<Row gutter={4}>\r\n\t\t\t\t\t\t\t\t\t<Col span={12}>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"cp-icon-btn\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Upload\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowUploadList={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\tbeforeUpload={this.beforeUpload}\r\n\t\t\t\t\t\t\t\t\t\t\t\taction={uploadEndpoint.url()}\r\n\t\t\t\t\t\t\t\t\t\t\t\tcustomRequest={uploadRequest}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonSuccess={this.handleUploadSuccess}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonError={this.handleUploadError}\r\n\t\t\t\t\t\t\t\t\t\t\t\twithCredentials={true}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<i className=\"la la-paperclip cp-fs-2x\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</Upload>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t\t<Col span={12}>\r\n\t\t\t\t\t\t\t\t\t\t<i className=\"cp-icon-btn la la-paper-plane cp-fs-2x\"\r\n\t\t\t\t\t\t\t\t\t\t   onClick={this.sendText}/>\r\n\t\t\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Row>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t} else if (!loadingChat) {\r\n\t\t\treturn <ChatNotFound onToggleDrawer={onToggleDrawer}/>;\r\n\t\t} else {\r\n\t\t\treturn <Loading/>;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = ({\r\n\tauth\r\n}) => ({\r\n\tauth : new Auth(auth)\r\n});\r\n\r\n\r\nexport default pipe(\r\n\tconnect(\r\n\t\tmapStateToProps\r\n\t),\r\n\tinjectIntl,\r\n)(Body);","import React, {Component} from 'react';\r\nimport {FormattedMessage} from \"react-intl\";\r\nimport {Button} from \"antd\";\r\n\r\nclass Empty extends Component {\r\n\trender() {\r\n\t\tconst {onToggleDrawer} = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"cp-comment-box\">\r\n\t\t\t\t<div className=\"cp-fs-80\">\r\n\t\t\t\t\t<i className=\"la la-comments\"/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<h1 className=\"text-muted\">\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tdefaultMessage=\"Select Chat to Begin!\"\r\n\t\t\t\t\t\tid=\"chat.select_to_begin\"/>\r\n\t\t\t\t</h1>\r\n\t\t\t\t<Button type=\"primary\"\r\n\t\t\t\t        className=\"d-block d-lg-none mt-3\"\r\n\t\t\t\t        onClick={onToggleDrawer}>\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tdefaultMessage=\"Show Chats\"\r\n\t\t\t\t\t\tid=\"chat.show_chats\"/>\r\n\t\t\t\t</Button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default Empty;","import React, {Component} from 'react';\r\nimport UserAvatar from \"components/UserAvatar\";\r\nimport {truncate, utcDateCalendarTime} from \"support/utils/common\";\r\nimport {find, isEmpty} from \"lodash\";\r\nimport {Avatar} from \"antd\";\r\nimport {FormattedMessage} from \"react-intl\";\r\nimport PrivateBroadcast from \"support/Services/Broadcast/Private\";\r\nimport ApiService from \"support/Services/Api\";\r\nimport {handleError, handleSuccess} from \"support/utils/promise\";\r\nimport millify from \"millify\";\r\n\r\nclass ChatCell extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.broadcast = new PrivateBroadcast();\r\n\t\tthis.api = new ApiService();\r\n\r\n\t\tthis.state = {\r\n\t\t\tparticipation : {}\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.bindBroadcastEvents();\r\n\t\tthis.fetchParticipation();\r\n\t}\r\n\r\n\tbindBroadcastEvents() {\r\n\t\tthis.resetBroadcastChannel();\r\n\t\tthis.broadcast.listen('ChatParticipationChanged', this.chatParticipationChangedListener);\r\n\t\tthis.broadcast.listen('ChatUpdated', this.chatUpdatedListener);\r\n\t}\r\n\r\n\tchatParticipationChangedListener = (participation) => {\r\n\t\tif (isEmpty(participation)) return;\r\n\t\tconst {auth} = this.props;\r\n\r\n\t\tif (auth.user.id === participation.user_id) {\r\n\t\t\tthis.setState({participation});\r\n\t\t}\r\n\t};\r\n\r\n\tchatUpdatedListener = (e) => {\r\n\t\tconst {axios, route} = this.api;\r\n\t\tif (isEmpty(e.chat)) return;\r\n\r\n\t\tthis.fetchParticipation();\r\n\r\n\t\tconst endpoint = route('chats.get', {\r\n\t\t\tchat : e.chat.id\r\n\t\t});\r\n\r\n\t\taxios.post(endpoint.url())\r\n\t\t\t.then(response => handleSuccess(response, (data) => {\r\n\t\t\t\tthis.updateChat(data)\r\n\t\t\t}))\r\n\t\t\t.catch(error => handleError(error));\r\n\t};\r\n\r\n\tupdateChat(chat) {\r\n\t\tconst {onChatUpdated} = this.props;\r\n\t\tif (typeof onChatUpdated === \"function\") {\r\n\t\t\treturn onChatUpdated(chat);\r\n\t\t}\r\n\t}\r\n\r\n\tresetBroadcastChannel() {\r\n\t\tconst {chat} = this.props;\r\n\t\tif (!isEmpty(chat)) {\r\n\t\t\tthis.broadcast.setChannel('App.Chat.' + chat.id)\r\n\t\t} else {\r\n\t\t\tthis.broadcast.unbind();\r\n\t\t}\r\n\t}\r\n\r\n\tfetchParticipation() {\r\n\t\tconst {axios, route} = this.api;\r\n\t\tconst {chat} = this.props;\r\n\r\n\t\tconst endpoint = route('chats.participation', {\r\n\t\t\tchat : chat.id\r\n\t\t});\r\n\r\n\t\taxios.post(endpoint.url())\r\n\t\t\t.then(response => handleSuccess(response, (data) => {\r\n\t\t\t\tthis.setState({participation : data})\r\n\t\t\t}))\r\n\t\t\t.catch(error => handleError(error));\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\r\n\t\tconst prevChat = prevProps.chat;\r\n\t\tconst chat = this.props.chat;\r\n\r\n\t\tif (prevChat.id !== chat.id) {\r\n\t\t\tconsole.info('ChatCell Updated');\r\n\t\t\tthis.resetBroadcastChannel();\r\n\t\t}\r\n\t}\r\n\r\n\tgetUserAvatar = () => {\r\n\t\tconst participant = this.getHighlightedParticipant();\r\n\r\n\t\tif (!isEmpty(participant)) {\r\n\t\t\treturn <UserAvatar user={participant.user} size={50}/>;\r\n\t\t} else {\r\n\t\t\treturn <Avatar icon=\"message\" size={50}/>;\r\n\t\t}\r\n\t};\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tthis.broadcast.unbind();\r\n\t\tthis.api.cancel();\r\n\t}\r\n\r\n\tgetTitle() {\r\n\t\tconst {chat} = this.props;\r\n\t\tconst participant = this.getHighlightedParticipant();\r\n\r\n\t\tif (isEmpty(participant)) {\r\n\t\t\treturn (\r\n\t\t\t\t<FormattedMessage\r\n\t\t\t\t\tdefaultMessage=\"Conversation\"\r\n\t\t\t\t\tid=\"chats.conversation\"/>\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tlet chatTitle = participant.user.name;\r\n\r\n\t\t\tif (chat.participants.length > 1) {\r\n\t\t\t\tchatTitle = (\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"chats.cell_title\"\r\n\t\t\t\t\t\tdefaultMessage=\"{user} and {total} other(s)\"\r\n\t\t\t\t\t\tvalues={{\r\n\t\t\t\t\t\t\ttotal : (chat.participants.length - 1),\r\n\t\t\t\t\t\t\tuser  : participant.user.name,\r\n\t\t\t\t\t\t}}/>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t<span className=\"font-weight-medium\">\r\n\t\t\t\t\t\t{chatTitle}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</React.Fragment>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tgetUser(id) {\r\n\t\tconst {chat, auth} = this.props;\r\n\t\tconst participants = chat.participants;\r\n\r\n\t\tif (auth.user.id === id) {\r\n\t\t\treturn auth.user;\r\n\t\t} else {\r\n\t\t\tconst participant = find(participants, function (o) {\r\n\t\t\t\treturn !isEmpty(o.user) && o.user.id === id;\r\n\t\t\t});\r\n\r\n\t\t\treturn !isEmpty(participant) ?\r\n\t\t\t\tparticipant.user : participant\r\n\t\t}\r\n\t}\r\n\r\n\tgetLastMessage() {\r\n\t\tconst {chat, auth} = this.props;\r\n\t\tconst latestMessage = chat.latest_message;\r\n\t\tconst participants = chat.participants;\r\n\r\n\t\tif (isEmpty(latestMessage)) return null;\r\n\r\n\t\tconst messageBy = latestMessage.user;\r\n\r\n\t\tif (!isEmpty(messageBy)) {\r\n\t\t\tif (messageBy.id === auth.user.id) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t<span className=\"font-weight-medium mr-1\">\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tdefaultMessage=\"Me\"\r\n\t\t\t\t\t\t\t\tid=\"common.me\"/>:\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t{this.getMessageDetail(latestMessage, 23)}\r\n\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t)\r\n\t\t\t} else if (participants.length > 1) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t<span className=\"font-weight-medium mr-1\">\r\n\t\t\t\t\t\t\t{messageBy.name}:\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t{this.getMessageDetail(latestMessage, 20)}\r\n\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t)\r\n\t\t\t} else {\r\n\t\t\t\treturn this.getMessageDetail(latestMessage, 25)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn (\r\n\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t<span className=\"font-weight-medium mr-1\">\r\n\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\tdefaultMessage=\"Unknown User\"\r\n\t\t\t\t\t\t\tid=\"common.unknown_user\"/>:\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t{this.getMessageDetail(latestMessage, 20)}\r\n\t\t\t\t</React.Fragment>\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\r\n\tgetMessageDetail = (message, length = 25) => {\r\n\t\tswitch (message.type) {\r\n\t\t\tcase \"activity\":\r\n\t\t\t\treturn this.getActivityDetail(message.activity, length);\r\n\t\t\tcase \"text\":\r\n\t\t\t\treturn this.getTextDetail(message.text, length);\r\n\t\t\tcase \"attachment\":\r\n\t\t\t\treturn this.getAttachmentDetail(message.attachment, length);\r\n\t\t\tdefault:\r\n\t\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\r\n\tgetTextDetail = (text, length) => {\r\n\t\tif (isEmpty(text)) {\r\n\t\t\treturn (\r\n\t\t\t\t<span>\r\n\t\t\t\t\t<i className=\"la la-ban mr-1\"/>\r\n\t\t\t\t\t<span>\r\n\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\tdefaultMessage=\"Message Deleted\"\r\n\t\t\t\t\t\t\tid=\"chats.message_deleted\"/>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</span>\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn (\r\n\t\t\t\t<span>\r\n\t\t\t\t\t{truncate(text.body, length)}\r\n\t\t\t\t</span>\r\n\t\t\t)\r\n\t\t}\r\n\t};\r\n\r\n\tgetAttachmentDetail = (attachment, length) => {\r\n\t\tif (isEmpty(attachment)) {\r\n\t\t\treturn (\r\n\t\t\t\t<span>\r\n\t\t\t\t\t<i className=\"la la-ban mr-1\"/>\r\n\t\t\t\t\t<span>\r\n\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\tdefaultMessage=\"Message Deleted\"\r\n\t\t\t\t\t\t\tid=\"chats.message_deleted\"/>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</span>\r\n\t\t\t)\r\n\t\t} else {\r\n\t\t\treturn (\r\n\t\t\t\t<span>\r\n\t\t\t\t\t<i className=\"la la-paperclip mr-1\"/>\r\n\t\t\t\t\t<span>\r\n\t\t\t\t\t\t{truncate(attachment.name, length)}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</span>\r\n\t\t\t)\r\n\t\t}\r\n\t};\r\n\r\n\tgetActivityDetail = (activity, length) => {\r\n\t\treturn activity && (\r\n\t\t\t<span>\r\n\t\t\t\t{truncate(activity.body, length)}\r\n\t\t\t</span>\r\n\t\t)\r\n\t};\r\n\r\n\tgetHighlightedParticipant() {\r\n\t\tif (isEmpty(this.highlightedParticpant)) {\r\n\t\t\tconst {chat, auth} = this.props;\r\n\t\t\tconst participants = chat.participants;\r\n\r\n\t\t\tthis.highlightedParticpant = find(participants, function (o) {\r\n\t\t\t\treturn !isEmpty(o.user) &&\r\n\t\t\t\t\to.user.id !== auth.user.id;\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn this.highlightedParticpant;\r\n\t}\r\n\r\n\tgetTime() {\r\n\t\tconst {chat} = this.props;\r\n\t\tconst latestMessage = chat.latest_message;\r\n\r\n\t\treturn !isEmpty(latestMessage) ?\r\n\t\t\tutcDateCalendarTime(latestMessage.created_at) :\r\n\t\t\tnull;\r\n\t}\r\n\r\n\thandleClick = () => {\r\n\t\tconst {onOpen, chat} = this.props;\r\n\t\tif (typeof onOpen === \"function\") {\r\n\t\t\treturn onOpen(chat);\r\n\t\t}\r\n\t};\r\n\r\n\tgetUnreadCount() {\r\n\t\tconst {participation} = this.state;\r\n\t\tconst {active} = this.props;\r\n\t\tif (active || isEmpty(participation)) return null;\r\n\r\n\t\tconst value = participation.unread_messages_count;\r\n\t\tif (!value || value <= 0) return null;\r\n\t\treturn millify(value);\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst unreadCount = this.getUnreadCount();\r\n\r\n\t\tconst {active} = this.props;\r\n\t\tconst cellClass = `cp-chat-user-item ${active && 'active'}`;\r\n\r\n\t\treturn (\r\n\t\t\t<div className={cellClass}\r\n\t\t\t     onClick={this.handleClick}>\r\n\t\t\t\t<div className=\"cp-chat-user-row\">\r\n\t\t\t\t\t<div className=\"cp-chat-avatar\">\r\n\t\t\t\t\t\t{this.getUserAvatar()}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"cp-chat-info\">\r\n\t\t\t\t\t\t<span className=\"cp-chat-name h4\">\r\n\t\t\t\t\t\t\t{this.getTitle()}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<div className=\"cp-chat-desc\">\r\n\t\t\t\t\t\t\t{this.getLastMessage()}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"cp-chat-time\">\r\n\t\t\t\t\t\t\t{this.getTime()}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"cp-chat-date\">\r\n\t\t\t\t\t\t{unreadCount && (\r\n\t\t\t\t\t\t\t<div className=\"badge\">\r\n\t\t\t\t\t\t\t\t{unreadCount}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default ChatCell;","import React, {Component} from 'react';\r\nimport {Badge, Icon, Input, List, Spin} from \"antd\";\r\nimport {defineMessages, FormattedMessage, injectIntl} from \"react-intl\";\r\nimport UserAvatar from \"components/UserAvatar\";\r\nimport ChatCell from \"./components/ChatCell\";\r\nimport InfiniteScroll from \"react-infinite-scroller\";\r\nimport {pipe, sortDate} from \"support/utils/common\";\r\nimport ApiService from \"support/Services/Api\";\r\nimport Pagination from \"support/Helpers/Pagination\";\r\nimport Auth from \"support/Auth\";\r\nimport {connect} from \"react-redux\";\r\nimport Loading from \"components/Loading\";\r\nimport {generatePath, withRouter} from \"react-router-dom\";\r\nimport SimpleBar from \"simplebar\";\r\nimport PrivateBroadcast from \"support/Services/Broadcast/Private\";\r\nimport {findIndex, isEmpty, uniqBy} from \"lodash\";\r\nimport {handleError, handleSuccess} from \"support/utils/promise\";\r\nimport menuItemLinks from \"containers/utils/menuItemLinks\";\r\n\r\nconst Item = List.Item;\r\n\r\nconst messages = defineMessages({\r\n\tsearchUsers : {\r\n\t\tdefaultMessage : \"Filter by contact name...\",\r\n\t\tid             : \"chats.input_filter_by_contact_name_placeholder\"\r\n\t},\r\n});\r\n\r\nclass Menu extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.broadcast = new PrivateBroadcast();\r\n\t\tthis.api = new ApiService();\r\n\r\n\t\tthis.state = {\r\n\t\t\tdata        : [],\r\n\t\t\thasMore     : false,\r\n\t\t\tparams      : {\r\n\t\t\t\ttotal    : 0,\r\n\t\t\t\tpageSize : 20,\r\n\t\t\t\tcurrent  : 1\r\n\t\t\t},\r\n\t\t\tfilters     : {\r\n\t\t\t\tuser : \"\",\r\n\t\t\t},\r\n\t\t\tloadingMore : false,\r\n\t\t\tloading     : false,\r\n\t\t};\r\n\r\n\t\tconst endpoint = this.api.route('chats.table').url();\r\n\t\tthis.pagination = new Pagination(this.api, endpoint);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.bindBroadcastEvents();\r\n\t\tthis.fetchChats();\r\n\t}\r\n\r\n\tbindBroadcastEvents() {\r\n\t\tthis.resetBroadcastChannel();\r\n\t\tthis.broadcast.listen('ChatParticipantCreated', this.chatParticipantCreatedListener);\r\n\t}\r\n\r\n\tchatParticipantCreatedListener = (e) => {\r\n\t\tconst {axios, route} = this.api;\r\n\t\tif (isEmpty(e.participant)) return;\r\n\r\n\t\tconst endpoint = route('chats.get', {\r\n\t\t\tchat : e.participant.chat_id\r\n\t\t});\r\n\r\n\t\taxios.post(endpoint.url())\r\n\t\t\t.then(response => handleSuccess(response, (chat) => {\r\n\t\t\t\tthis.setState(({data}) => {\r\n\t\t\t\t\tconst chats = data.concat(chat);\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tdata : this.sortChats(chats)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}))\r\n\t\t\t.catch(error => handleError(error));\r\n\t};\r\n\r\n\tonChatUpdated = (chat) => {\r\n\t\tconst {data} = this.state;\r\n\t\tconst index = findIndex(data, function (o) {\r\n\t\t\treturn o.id === chat.id\r\n\t\t});\r\n\r\n\t\tlet chats = [...data];\r\n\t\tif (index < 0) {\r\n\t\t\tchats = chats.concat(chat);\r\n\t\t} else {\r\n\t\t\tchats[index] = chat;\r\n\t\t}\r\n\r\n\t\tchats = this.sortChats(chats);\r\n\t\tthis.setState({data : chats});\r\n\t};\r\n\r\n\tsortChats = (chats) => {\r\n\t\tif (!Array.isArray(chats)) return chats;\r\n\t\tchats = chats.sort((a, b) => sortDate(b.updated_at, a.updated_at));\r\n\t\treturn uniqBy(chats, 'id');\r\n\t};\r\n\r\n\tresetBroadcastChannel() {\r\n\t\tconst {auth} = this.props;\r\n\t\tif (auth.check()) {\r\n\t\t\tthis.broadcast.setChannel('Auth.User.' + auth.user.id)\r\n\t\t} else {\r\n\t\t\tthis.broadcast.unbind();\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\r\n\t\tconst prevUser = prevProps.auth.user;\r\n\t\tconst user = this.props.auth.user;\r\n\r\n\t\tif (prevUser.id !== user.id) {\r\n\t\t\tconsole.info('Menu Updated');\r\n\t\t\tthis.resetBroadcastChannel();\r\n\t\t}\r\n\t}\r\n\r\n\tfetchChats = () => {\r\n\t\tconst {params, filters} = this.state;\r\n\t\tconst nextParams = {...params, current : 1};\r\n\r\n\t\tthis.pagination.fetchData(\r\n\t\t\tnextParams, filters, (page) => {\r\n\t\t\t\tthis.setState(() => {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tparams  : {...nextParams, total : page.meta.total},\r\n\t\t\t\t\t\tdata    : page.data,\r\n\t\t\t\t\t\tloading : false,\r\n\t\t\t\t\t\thasMore : Boolean(page.links.next),\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.setState({loading : false})\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tthis.setState({loading : true});\r\n\t};\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tthis.broadcast.unbind();\r\n\t\tthis.api.cancel();\r\n\t}\r\n\r\n\tcanSearchUser() {\r\n\t\tconst {loading, loadingMore} = this.state;\r\n\t\treturn !(loading || loadingMore);\r\n\t}\r\n\r\n\tcanLoadMore() {\r\n\t\tconst {hasMore, loadingMore, loading} = this.state;\r\n\t\treturn (hasMore && !loadingMore && !loading);\r\n\t}\r\n\r\n\tonChangeUserSearch = (e) => {\r\n\t\tconst value = e.target.value;\r\n\t\tclearTimeout(this.searching);\r\n\r\n\t\tconst {filters} = this.state;\r\n\t\tif (!this.canSearchUser()) return;\r\n\r\n\t\tthis.setState({\r\n\t\t\tfilters : {...filters, user : value}\r\n\t\t});\r\n\r\n\t\tthis.searching = setTimeout(\r\n\t\t\tthis.fetchChats, 2000\r\n\t\t);\r\n\t};\r\n\r\n\tonSearchKeyUp = (e) => {\r\n\t\tif (e.key === 'Enter') {\r\n\t\t\tclearTimeout(this.searching);\r\n\t\t\tthis.fetchChats();\r\n\t\t}\r\n\t};\r\n\r\n\tonLoadMore = (page) => {\r\n\t\tif (!this.canLoadMore()) return;\r\n\r\n\t\tconst {params, filters} = this.state;\r\n\t\tlet nextParams = {...params, current : params.current + 1};\r\n\r\n\t\tthis.pagination.fetchData(\r\n\t\t\tnextParams, filters, (page) => {\r\n\t\t\t\tthis.setState(({data}) => {\r\n\t\t\t\t\tconst updatedData = data.concat(page.data);\r\n\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tdata        : this.sortChats(updatedData),\r\n\t\t\t\t\t\tparams      : {...nextParams, total : page.meta.total},\r\n\t\t\t\t\t\tloadingMore : false,\r\n\t\t\t\t\t\thasMore     : Boolean(page.links.next),\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}, () => {\r\n\t\t\t\tthis.setState({loadingMore : false})\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tthis.setState({loadingMore : true});\r\n\t};\r\n\r\n\thandleChatOpen = (chat) => {\r\n\t\tconst {history} = this.props;\r\n\r\n\t\tconst path = generatePath(menuItemLinks['chat.view'].path, {\r\n\t\t\ttoken : chat.id\r\n\t\t});\r\n\r\n\t\tif (!isEmpty(history)) {\r\n\t\t\treturn history.replace(path);\r\n\t\t}\r\n\t};\r\n\r\n\tsetScrollWrapper = (ref) => {\r\n\t\tif (ref !== this.scrollWrapper && ref !== null) {\r\n\t\t\tconst simpleBar = new SimpleBar(ref);\r\n\t\t\tthis.scrollParent = simpleBar.getScrollElement();\r\n\t\t\tthis.scrollWrapper = ref\r\n\t\t}\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst {loading, loadingMore, hasMore, filters, data} = this.state;\r\n\r\n\t\tconst {intl, auth, activeChat} = this.props;\r\n\r\n\t\tconst totalActiveTrades = auth.user.marketplace_stats.total_active_trades;\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"cp-chat-sidenav-main\">\r\n\t\t\t\t<div className=\"cp-chat-sidenav-header\">\r\n\t\t\t\t\t<div className=\"cp-chat-user-hd\">\r\n\t\t\t\t\t\t<div className=\"cp-chat-avatar mr-3\">\r\n\t\t\t\t\t\t\t<UserAvatar user={auth.user}\r\n\t\t\t\t\t\t\t            showPresence={false}\r\n\t\t\t\t\t\t\t            size={50}/>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className=\"cp-module-user-info flex-column justify-content-center\">\r\n\t\t\t\t\t\t\t<div className=\"cp-module-title\">\r\n\t\t\t\t\t\t\t\t<h5 className=\"mb-0\">\r\n\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Conversations\"\r\n\t\t\t\t\t\t\t\t\t\tid=\"chats.conversations\"/>\r\n\t\t\t\t\t\t\t\t</h5>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"cp-module-user-detail\">\r\n\t\t\t\t\t\t\t\t<div className=\"cp-text-grey d-flex my-1 align-items-center\">\r\n\t\t\t\t\t\t\t\t\t{totalActiveTrades > 0 && (\r\n\t\t\t\t\t\t\t\t\t\t<Badge count={totalActiveTrades}\r\n\t\t\t\t\t\t\t\t\t\t       style={{backgroundColor : '#2db7f5'}}\r\n\t\t\t\t\t\t\t\t\t\t       className=\"mb-0 mr-2\"/>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Active Trades\"\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"common.active_trades\"/>\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"cp-chat-search-wrapper\">\r\n\t\t\t\t\t\t<Input suffix={<Icon type=\"search\"/>}\r\n\t\t\t\t\t\t       placeholder={intl.formatMessage(messages.searchUsers)}\r\n\t\t\t\t\t\t       size=\"large\"\r\n\t\t\t\t\t\t       onKeyUp={this.onSearchKeyUp}\r\n\t\t\t\t\t\t       disabled={!this.canSearchUser()}\r\n\t\t\t\t\t\t       onChange={this.onChangeUserSearch}\r\n\t\t\t\t\t\t       value={filters.user}/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"cp-chat-sidenav-content\">\r\n\t\t\t\t\t<Spin spinning={loading}>\r\n\t\t\t\t\t\t<div ref={this.setScrollWrapper}\r\n\t\t\t\t\t\t     className=\"cp-chat-sidenav-scroll\"\r\n\t\t\t\t\t\t     data-simplebar={true}>\r\n\t\t\t\t\t\t\t<InfiniteScroll useWindow={false}\r\n\t\t\t\t\t\t\t                getScrollParent={() => this.scrollParent}\r\n\t\t\t\t\t\t\t                loadMore={this.onLoadMore}\r\n\t\t\t\t\t\t\t                pageStart={1}\r\n\t\t\t\t\t\t\t                hasMore={!loadingMore && hasMore}\r\n\t\t\t\t\t\t\t                initialLoad={false}>\r\n\t\t\t\t\t\t\t\t<div className=\"cp-chat-user\">\r\n\t\t\t\t\t\t\t\t\t<List\r\n\t\t\t\t\t\t\t\t\t\tdataSource={data}\r\n\t\t\t\t\t\t\t\t\t\trowKey={(record) => record.id}\r\n\t\t\t\t\t\t\t\t\t\trenderItem={item => {\r\n\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Item className=\"p-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<ChatCell\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChatUpdated={this.onChatUpdated}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tactive={activeChat && activeChat.token === item.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tauth={auth} chat={item}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonOpen={this.handleChatOpen}/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Item>\r\n\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t}}/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{loadingMore && <Loading/>}\r\n\t\t\t\t\t\t\t</InfiniteScroll>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</Spin>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = ({\r\n\tauth\r\n}) => ({\r\n\tauth : new Auth(auth)\r\n});\r\n\r\n\r\nexport default pipe(\r\n\tconnect(\r\n\t\tmapStateToProps\r\n\t),\r\n\tinjectIntl,\r\n\twithRouter\r\n)(Menu);","import React, {Component} from 'react';\r\nimport {pipe} from \"support/utils/common\";\r\nimport {connect} from \"react-redux\";\r\nimport {Drawer} from \"antd\";\r\nimport {matchPath, withRouter} from \"react-router-dom\";\r\nimport Auth from \"support/Auth\";\r\nimport Empty from \"./components/Empty\";\r\nimport Fullscreen from \"react-full-screen\";\r\nimport Menu from \"./components/Menu\";\r\nimport Body from \"./components/Body\";\r\nimport menuItemLinks from \"containers/utils/menuItemLinks\";\r\nimport context from \"context\";\r\nimport {Helmet} from \"react-helmet\";\r\nimport {defineMessages, injectIntl} from \"react-intl\";\r\n\r\nconst messages = defineMessages({\r\n\tpageTitle : {\r\n\t\tdefaultMessage : \"Chat | {name}\",\r\n\t\tid             : \"meta.title.chat\"\r\n\t},\r\n});\r\n\r\nclass Chats extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\tdrawerState : false,\r\n\t\t\tfullscreen  : false\r\n\t\t}\r\n\t}\r\n\r\n\tonToggleDrawer = () => {\r\n\t\tthis.setState((state) => {\r\n\t\t\treturn {\r\n\t\t\t\tdrawerState : !state.drawerState,\r\n\t\t\t\tfullscreen  : false\r\n\t\t\t};\r\n\t\t});\r\n\t};\r\n\r\n\tonToggleFullscreen = () => {\r\n\t\tthis.setState((state) => {\r\n\t\t\treturn {\r\n\t\t\t\tfullscreen  : !state.fullscreen,\r\n\t\t\t\tdrawerState : false\r\n\t\t\t};\r\n\t\t})\r\n\t};\r\n\r\n\tonChangeFullscreen = (fullscreen) => {\r\n\t\tthis.setState({fullscreen})\r\n\t};\r\n\r\n\tgetActiveChatParams = () => {\r\n\t\tconst {location} = this.props;\r\n\r\n\t\tconst match = matchPath(location.pathname, {\r\n\t\t\texact  : true,\r\n\t\t\tpath   : menuItemLinks['chat.view'].path,\r\n\t\t\tstrict : false\r\n\t\t});\r\n\r\n\t\treturn match && match.params;\r\n\t};\r\n\r\n\tgetPageTitle() {\r\n\t\tconst {intl} = this.props;\r\n\r\n\t\treturn intl.formatMessage(messages.pageTitle, {\r\n\t\t\tname : context.name\r\n\t\t})\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst activeChat = this.getActiveChatParams();\r\n\t\tconst {drawerState, fullscreen} = this.state;\r\n\r\n\t\tconst sidebar = <Menu activeChat={activeChat}/>;\r\n\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<Helmet>\r\n\t\t\t\t\t<title>\r\n\t\t\t\t\t\t{this.getPageTitle()}\r\n\t\t\t\t\t</title>\r\n\t\t\t\t</Helmet>\r\n\r\n\t\t\t\t<Fullscreen\r\n\t\t\t\t\tonChange={this.onChangeFullscreen}\r\n\t\t\t\t\tenabled={fullscreen}>\r\n\t\t\t\t\t<div className=\"cp-app-module cp-chat-module\">\r\n\t\t\t\t\t\t<div className=\"cp-chat-module-box\">\r\n\t\t\t\t\t\t\t<div className=\"d-block d-lg-none\">\r\n\t\t\t\t\t\t\t\t<Drawer visible={drawerState}\r\n\t\t\t\t\t\t\t\t        closable={false}\r\n\t\t\t\t\t\t\t\t        onClose={this.onToggleDrawer}\r\n\t\t\t\t\t\t\t\t        placement=\"left\">\r\n\t\t\t\t\t\t\t\t\t{sidebar}\r\n\t\t\t\t\t\t\t\t</Drawer>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div className=\"cp-chat-sidenav d-none d-lg-flex\">\r\n\t\t\t\t\t\t\t\t{sidebar}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{activeChat ? (\r\n\t\t\t\t\t\t\t\t<Body key={activeChat.token}\r\n\t\t\t\t\t\t\t\t      onChangeFullscreen={this.onChangeFullscreen}\r\n\t\t\t\t\t\t\t\t      onToggleFullscreen={this.onToggleFullscreen}\r\n\t\t\t\t\t\t\t\t      fullscreen={fullscreen}\r\n\t\t\t\t\t\t\t\t      onToggleDrawer={this.onToggleDrawer}\r\n\t\t\t\t\t\t\t\t      activeChat={activeChat}/>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<Empty onToggleDrawer={this.onToggleDrawer}/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Fullscreen>\r\n\t\t\t</React.Fragment>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = ({\r\n\tauth\r\n}) => ({\r\n\tauth : new Auth(auth)\r\n});\r\n\r\nexport default pipe(\r\n\tconnect(\r\n\t\tmapStateToProps,\r\n\t),\r\n\tinjectIntl,\r\n\twithRouter\r\n)(Chats);\r\n\r\nif (module.hot) {\r\n\tmodule.hot.accept()\r\n}"],"sourceRoot":""}